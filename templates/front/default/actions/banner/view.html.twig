{% trans_default_domain 'front_default' %}

{% if entities %}
    {% set isFirst = true %}
    {% set category = entities|first.category %}
    {% set maxWidth = category.maxWidth is defined and category.maxWidth ? category.maxWidth : 728 %}
    <div id="carousel-banner-teaser"
         class="carousel banner-carousel slide carousel-fade d-inline-flex justify-content-end"
         data-bs-interval="4000"
         data-bs-pause="false"
         data-bs-autoplay="true"
         data-bs-ride="carousel"{% if maxWidth %} style="max-width: {{ maxWidth }}px"{% endif %}
         data-component="banner">
        <div class="carousel-inner">
            {% for entity in entities %}
                {% set i18n = entity|i18n %}
                {% set category = entity.category %}
                {% set maxWidth = category.maxWidth is defined and category.maxWidth ? category.maxWidth : 728 %}
                {% set maxHeight = category.maxHeight is defined and category.maxHeight ? category.maxHeight : 90 %}
                {% set tabletMaxWidth = category.tabletMaxWidth is defined and category.tabletMaxWidth ? category.tabletMaxWidth : maxWidth %}
                {% set tabletMaxHeight = category.tabletMaxHeight is defined and category.tabletMaxHeight ? category.tabletMaxHeight : maxHeight %}
                {% set mobileMaxWidth = category.mobileMaxWidth is defined and category.mobileMaxWidth ? category.mobileMaxWidth : tabletMaxWidth %}
                {% set mobileMaxHeight = category.mobileMaxHeight is defined and category.mobileMaxHeight ? category.mobileMaxHeight : tabletMaxHeight %}
                {% set mediaRelation = entity|i18nMedia %}
                {% if mediaRelation %}
                    {% set media = mediaRelation.media %}
                    {% set mediaPath = 'uploads/' ~ website.uploadDirname ~ '/' ~ media.filename %}
                    {% set i18nMedia = mediaRelation.i18n %}
                    {% set link = i18nMedia|i18nLink %}
                    <div class="carousel-item{% if isFirst %} active{% endif %}">
                        {% set title = i18n.title is defined and i18n.title ? i18n.title : entity.adminName %}
                        <div class="banner banner-{{ entity.slug }}" data-path="{{ path('front_banner_handler', {'banner': entity.id}) }}">
                            {% if link.link %}
                                <a href="{{ link.link }}" aria-label="{{ title|striptags }}"
                                    {% if link.targetBlank %} target="_blank"{% endif %}
                                    {% if link.externalLink %} rel="noopener noreferrer"{% endif %}>
                            {% endif %}
                                {{ imgRender({'src': asset(mediaPath),
                                    'screensSizes': {
                                        'mobile': {'width': mobileMaxWidth, 'height': mobileMaxHeight},
                                        'tablet': {'width': tabletMaxWidth, 'height': tabletMaxHeight},
                                        'desktop': {'width': maxWidth, 'height': maxHeight}
                                    }
                                }) }}
                            {% if link.link %}
                                </a>
                            {% endif %}
                        </div>
                    </div>
                    {% set isFirst = false %}
                {% endif %}
            {% endfor %}
        </div>
    </div>
{% endif %}